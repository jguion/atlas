<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="/static/jquery-ui-1.12.1.custom/jquery-ui.css" />
    <link rel="stylesheet" href="/static/fullcalendar-3.0.1/fullcalendar.css" />
    <script type='text/javascript' src="/static/jquery-3.1.1.min.js"></script>
    <script type='text/javascript' src="/static/jquery-ui-1.12.1.custom/jquery-ui.js"></script>
    <script type='text/javascript' src="/static/fullcalendar-3.0.1/lib/moment.min.js"></script>
    <script type='text/javascript' src="/static/fullcalendar-3.0.1/fullcalendar.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>

    <script>
    $( function() {
      $( "#header" ).load("/static/header.html");
      $( "#tabs" ).tabs();

      //Create the tables
      google.charts.load('current', {'packages':['table']});
      google.charts.setOnLoadCallback(drawTable);

      var data;
      var table;
      var options;

      function drawTable() {
        data = new google.visualization.DataTable();
        data.addColumn('string', 'Mission');
        data.addColumn('string', 'Organization')
        data.addColumn('datetime', 'Start Time');
        data.addColumn('datetime', 'End Time');
        data.addRows([
          ['Take pictures', 'Intel', new Date(2016, 9, 30, 12, 00, 00), new Date(2016, 9, 30, 18, 00, 00)],
          ['Drop bombs', 'Bombers',  new Date(2016, 9, 30, 14, 00, 00), new Date(2016, 9, 30, 18, 00, 00)],
          ['Hack bad guys', '24 AF',  new Date(2016, 9, 30, 15, 00, 00), new Date(2016, 9, 30, 23, 00, 00)]
        ]);

        table = new google.visualization.Table(document.getElementById('current_mission_table'));
        options = {showRowNumber: true, width: '100%', height:'100%'}
        table.draw(data, options);
      }

      //End create table

      //Create the add mission box

      //what to do when you add mission
      function addMission(){
        data.addRow([$('#name').val(),
                     $('#organization').val(),
                     new Date($('#start')[0].valueAsNumber),
                     new Date($('#end')[0].valueAsNumber)
                   ]);
        table.draw(data, options);
        dialog.dialog("close");
        return true;
      }

      dialog = $( "#dialog-form" ).dialog({
        autoOpen: false,
        height: 550,
        width: 450,
        modal: true,
        buttons: {
          "Add Mission": addMission,
          Cancel: function() {
            dialog.dialog( "close" );
          }
        },
        close: function() {
          form[ 0 ].reset();
        }
      });

      form = dialog.find( "form" ).on( "submit", function( event ) {
        event.preventDefault();
        addMission();
      });

      $( "#add_mission_btn" ).button().on( "click", function() {
        dialog.dialog( "open" );
      });
      // End add mission box

      //calendar
      $("#tabs-2_link").click(function(){
        $('#calendar').fullCalendar({
          header: {
        				left: 'prev,next today',
        				center: 'title',
        				right: 'month,agendaWeek,agendaDay,listWeek'
        			},
        			navLinks: true, // can click day/week names to navigate views
        			editable: false,
        			eventLimit: true, // allow "more" link when too many events
        			events: [
        				{
        					title: 'All Day Mission',
        					start: '2016-10-01'
        				},
        				{
        					title: 'Long Mission',
        					start: '2016-10-07',
        					end: '2016-10-10'
        				},
        				{
        					id: 999,
        					title: 'Repeating Mission',
        					start: '2016-10-09T16:00:00'
        				},
        				{
        					id: 999,
        					title: 'Repeating Mission',
        					start: '2016-10-16T16:00:00'
        				},
        				{
        					title: 'Conference',
        					start: '2016-10-11',
        					end: '2016-10-13'
        				},
        				{
        					title: 'Mission',
        					start: '2016-10-12T10:30:00',
        					end: '2016-10-12T12:30:00'
        				},
        				{
        					title: 'Mission',
        					start: '2016-10-12T14:30:00'
        				},
        				{
        					title: 'Another Mission',
        					start: '2016-10-13T07:00:00'
        				}
        			]
        });
      });

    });//end ready


    </script>
    <style>
      .ui-menu .ui-menu-item {
          display: inline-block;
          float: left;
          margin: 0;
          padding: 0;
          width: auto;
      }
      .ui-menu:after {
        content: ".";
        display: block;
        clear: both;
        visibility: hidden;
        line-height: 0;
        height: 0;
    }
    #add_mission_btn {
      float: right;
    }
    label, input { display:block; }
    input.text { margin-bottom:12px; width:95%; padding: .4em; }
    fieldset { padding:0; border:0; margin-top:25px; }
  </style>
  </head>
  <body>
    <div id="header"></div>

    <div id="dialog-form" title="Add new mission">
    <form>
      <fieldset>
        <label for="name">Name</label>
        <input type="text" name="name" id="name" value="" class="text ui-widget-content ui-corner-all">
        <label for="type">Type</label>
        <input type="text" name="type" id="type" value="" class="text ui-widget-content ui-corner-all">
        <label for="organization">Organization</label>
        <input type="text" name="organization" id="organization" value="" class="text ui-widget-content ui-corner-all">
        <label for="start">Start time</label>
        <input type="datetime-local" name="start" id="start" value="" class="text ui-widget-content ui-corner-all">
        <label for="end">End time</label>
        <input type="datetime-local" name="end" id="end" value="" class="text ui-widget-content ui-corner-all">

        <!-- Allow form submission with keyboard without duplicating the dialog button -->
        <input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
      </fieldset>
    </form>
  </div>

    <h1>Missions</h1>
    <div id="tabs">
    <ul>
      <li><a href="#tabs-1">Today's Missions</a></li>
      <li><a id="tabs-2_link" href="#tabs-2">Upcoming Missions</a></li>
      <li><a href="#tabs-3">Missions Map</a></li>
      <button class="ui-button ui-widget ui-corner-all" id="add_mission_btn">Add Mission</button>
    </ul>
    <div id="tabs-1">
      <div id="current_mission_table"></div>
    </div>
    <div id="tabs-2">
      <div id='calendar'></div>
    </div>
    <div id="tabs-3">
      <p>Pretty picture</p>
    </div>
  </div>
  </body>
</html>
